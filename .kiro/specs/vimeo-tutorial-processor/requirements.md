# 要件仕様書

## 概要
Houdini公式チュートリアルサイトに埋め込まれているVimeo動画から英語字幕を自動抽出し、ユーザーが指定した言語に翻訳した上で、Houdini初学者向けのHTML学習ドキュメントを生成するツールです。このツールにより、言語の壁を取り除き、世界中のユーザーがHoudiniの高度な機能を学習できるようになります。

## 要件

### 要件1: チュートリアルURLの入力と検証
**ユーザーストーリー:** Houdini学習者として、公式チュートリアルのURLを入力して、そのページからVimeo動画を含むコンテンツを処理したい

#### 受け入れ基準
1. WHEN ユーザーがHoudini公式チュートリアルのURLを入力した THEN システムはURLの妥当性を検証する
2. WHEN URLが有効でVimeo動画が存在する THEN システムは動画IDを抽出して処理準備状態に移行する
3. IF URLが無効または動画が見つからない THEN エラーメッセージを表示して再入力を促す
4. WHEN 複数のVimeo動画が含まれている THEN 現在の処理状態を確認後、デフォルトで頭から全処理、オプションで選択可能

### 要件2: Vimeo動画字幕の抽出
**ユーザーストーリー:** Houdini学習者として、Vimeo動画から英語字幕を自動的に抽出して、翻訳の元データとして利用したい

#### 受け入れ基準
1. WHEN Vimeo動画IDが特定された THEN システムは利用可能な字幕トラックを検出する
2. WHEN 英語字幕が存在する THEN SRT形式で字幕データを抽出する
3. IF 英語字幕が存在しない THEN エラーメッセージを表示して処理を中断する
4. WHEN 字幕抽出が完了した THEN タイムスタンプ付きのテキストデータとして保存する
5. IF 字幕抽出中にエラーが発生した THEN 詳細なエラー情報とリトライオプションを表示する

### 要件3: 字幕のチャンク化と集約
**ユーザーストーリー:** Houdini学習者として、抽出されたVimeo動画の字幕を意味のあるチャンクに集約して、理解しやすい単位で学習したい

#### 受け入れ基準
1. WHEN 字幕データが抽出された THEN 自然な段落や話題の切り替わりを検出してチャンクに分割する
2. WHEN 短い字幕が連続している THEN 文脈を考慮して3-5文程度の意味のあるチャンクに集約する
3. WHEN チャンク分割が完了した THEN 各チャンクにタイムスタンプ範囲（開始時刻〜終了時刻）を付与する
4. WHEN チャンクサイズの設定が指定された THEN 最小/最大文字数の制約内でチャンクを生成する

### 要件4: 英語版Markdown学習ドキュメントの生成
**ユーザーストーリー:** Houdini初学者として、字幕内容に加えて理解を助ける用語解説を含んだ構造化されたMarkdown形式の学習ドキュメントを取得したい

#### 受け入れ基準
1. WHEN Markdownドキュメントを生成する THEN 冒頭に元のチュートリアルURL、タイトル、概要説明を含める
2. WHEN チャンク化された字幕が準備された THEN 適切なMarkdown見出し構造（H1-H3）で章立てを作成する
3. WHEN 動画のタイムスタンプが含まれている THEN `[時刻表記](元動画URL#t=123s)` 形式でリンクを生成する
4. WHEN コードブロックや技術的内容が検出された THEN 適切な```記法とシンタックスハイライト指定を適用する
5. WHEN 画像やスクリーンショットが必要な場合 THEN `![説明](images/screenshot_001.png)` 形式でプレースホルダーを生成する
6. WHEN 目次が必要な場合 THEN Markdown TOC形式で自動生成する
7. WHEN 各セクションで専門用語が使用された THEN セクション末尾に「📝 用語解説」として初学者向けの説明を追加する
8. WHEN 用語解説を追加する THEN 用語名、読み方（該当する場合）、簡潔な説明を含める

### 要件5: 出力言語の選択と翻訳設定
**ユーザーストーリー:** Houdini学習者として、希望する言語を選択して、技術用語の扱い方を設定したい

#### 受け入れ基準
1. WHEN ユーザーが翻訳先言語を選択する THEN サポートされている言語リストから選択できる
2. WHEN 日本語、中国語、韓国語、スペイン語、フランス語、ドイツ語から選択した THEN 最適化された翻訳エンジンを自動選択する
3. WHEN Houdini専門用語の扱いを設定する THEN 「そのまま保持」「カタカナ表記」「現地語訳」から選択できる
4. IF カスタム用語集がアップロードされた THEN 翻訳時に優先的に適用する

### 要件6: Markdownドキュメントの翻訳処理
**ユーザーストーリー:** Houdini学習者として、生成されたMarkdown学習ドキュメントを選択した言語に正確に翻訳してもらいたい

#### 受け入れ基準
1. WHEN 翻訳処理が開始された THEN 翻訳マーカー間のテキストのみを抽出して処理する
2. WHEN 技術用語（ノード名、パラメータ名など）が検出された THEN 設定に従って処理する
3. WHEN 文脈に応じた翻訳が必要な場合 THEN チャンク内の文章全体を考慮して適切に翻訳する
4. IF 翻訳品質が低い箇所が検出された THEN フラグを立てて手動確認を促す
5. WHEN 翻訳が完了した THEN 元のMarkdown構造を保持して翻訳結果を反映する
6. WHEN バッチ処理モードが有効な場合 THEN 複数の言語版を順次処理してキューイングする

### 要件7: HTMLドキュメントの変換と最終生成
**ユーザーストーリー:** Houdini学習者として、翻訳されたMarkdownを美しいHTMLドキュメントとして取得したい

#### 受け入れ基準
1. WHEN Markdownの変換が開始された THEN レスポンシブデザインのHTMLテンプレートを適用する
2. WHEN `vimeo://timestamp`リンクを処理する THEN クリック可能なタイムラインナビゲーションに変換する
3. WHEN 画像プレースホルダーを処理する THEN 実際の画像ファイルを動画から自動抽出して配置する
4. WHEN コードブロックを変換する THEN シンタックスハイライトを適用してレンダリングする
5. WHEN 複数言語版が完成した THEN 言語切り替えナビゲーションと言語別ディレクトリ構造を生成する
6. IF 右から左へ書く言語（アラビア語など）の場合 THEN RTLレイアウトを自動適用する
7. WHEN 最終パッケージを生成する THEN すべてのアセットを含む自己完結型HTMLを作成する

### 要件8: 用語集の管理
**ユーザーストーリー:** チュートリアル作成者として、Houdini専門用語の翻訳を一元管理して一貫性を保ちたい

#### 受け入れ基準
1. WHEN 新しい専門用語が検出された THEN 用語集への追加を提案する
2. WHEN 用語集エディタを開いた THEN CSV/JSON形式でインポート/エクスポートできる
3. WHEN 用語の翻訳を更新した THEN 過去に生成されたドキュメントへの反映オプションを提供する
4. IF 複数の翻訳候補が存在する THEN コンテキストに基づいて最適な候補を自動選択する


### 要件8: エクスポート
**ユーザーストーリー:** チュートリアル作成者として、完成したドキュメントをHTML形式でエクスポートしたい

#### 受け入れ基準
1. WHEN エクスポートを実行した THEN HTML形式で出力される
2. WHEN HTMLファイルを生成した THEN CSS/JSをインライン化した自己完結型ファイルとなる


### 要件9: 一時ファイルの管理
**ユーザーストーリー:** システム利用者として、処理中に生成される一時ファイルが適切に管理されることを期待する

#### 受け入れ基準
1. WHEN 処理中に一時ファイルが生成された THEN 処理完了後に自動削除する