# 要件仕様書

## 概要
Houdini公式チュートリアルサイトに埋め込まれているVimeo動画から英語字幕を自動抽出し、ユーザーが指定した言語に翻訳した上で、Houdini初学者向けのHTML学習ドキュメントを生成するツールです。このツールにより、言語の壁を取り除き、世界中のユーザーがHoudiniの高度な機能を学習できるようになります。

## 要件

### 要件1: チュートリアルURLの入力と検証
**ユーザーストーリー:** Houdini学習者として、公式チュートリアルのURLを入力して、そのページからVimeo動画を含むコンテンツを処理したい

#### 受け入れ基準
1. WHEN ユーザーがHoudini公式チュートリアルのURLを入力した THEN システムはURLの妥当性を検証する
2. WHEN URLが有効でVimeo動画が存在する THEN システムは動画IDを抽出して処理準備状態に移行する
3. IF URLが無効または動画が見つからない THEN エラーメッセージを表示して再入力を促す
4. WHEN 複数のVimeo動画が含まれている THEN すべての動画を検出してリスト表示する

### 要件2: Vimeo動画字幕の抽出
**ユーザーストーリー:** Houdini学習者として、Vimeo動画から英語字幕を自動的に抽出して、翻訳の元データとして利用したい

#### 受け入れ基準
1. WHEN Vimeo動画IDが特定された THEN システムは利用可能な字幕トラックを検出する
2. WHEN 英語字幕が存在する THEN VTT/SRT形式で字幕データを抽出する
3. IF 英語字幕が存在しない THEN 音声認識による自動字幕生成オプションを提示する
4. WHEN 字幕抽出が完了した THEN タイムスタンプ付きのテキストデータとして保存する
5. IF 字幕抽出中にエラーが発生した THEN 詳細なエラー情報とリトライオプションを表示する

### 要件3: 字幕のチャンク化と集約
**ユーザーストーリー:** Houdini学習者として、抽出されたVimeo動画の字幕を意味のあるチャンクに集約して、理解しやすい単位で学習したい

#### 受け入れ基準
1. WHEN 字幕データが抽出された THEN 自然な段落や話題の切り替わりを検出してチャンクに分割する
2. WHEN 短い字幕が連続している THEN 文脈を考慮して3-5文程度の意味のあるチャンクに集約する
3. WHEN チャンク分割が完了した THEN 各チャンクにタイムスタンプ範囲（開始時刻〜終了時刻）を付与する
4. IF 手動でチャンク境界を調整したい場合 THEN インタラクティブなエディタで分割位置を編集できる
5. WHEN チャンクサイズの設定が指定された THEN 最小/最大文字数の制約内でチャンクを生成する

### 要件4: 英語版Markdown学習ドキュメントの生成
**ユーザーストーリー:** AIエージェントの作業効率化として、まず構造化されたMarkdown形式で学習ドキュメントを生成し、その後HTML変換と翻訳処理を実行したい

#### 受け入れ基準
1. WHEN チャンク化された字幕が準備された THEN 適切なMarkdown見出し構造（H1-H3）で章立てを作成する
2. WHEN 動画のタイムスタンプが含まれている THEN `[時刻表記](vimeo://timestamp)` 形式でリンクを生成する
3. WHEN コードブロックや技術的内容が検出された THEN 適切な```記法とシンタックスハイライト指定を適用する
4. WHEN 画像やスクリーンショットが必要な場合 THEN `![説明](images/screenshot_001.png)` 形式でプレースホルダーを生成する
5. WHEN 目次が必要な場合 THEN Markdown TOC形式で自動生成する
6. WHEN Markdownが完成した THEN 翻訳用マーカー（`<!-- translate-start --><!-- translate-end -->`）を挿入する

### 要件5: 出力言語の選択と翻訳設定
**ユーザーストーリー:** Houdini学習者として、希望する言語を選択して、技術用語の扱い方を設定したい

#### 受け入れ基準
1. WHEN ユーザーが翻訳先言語を選択する THEN サポートされている言語リストから選択できる
2. WHEN 日本語、中国語、韓国語、スペイン語、フランス語、ドイツ語から選択した THEN 最適化された翻訳エンジンを自動選択する
3. WHEN Houdini専門用語の扱いを設定する THEN 「そのまま保持」「カタカナ表記」「現地語訳」から選択できる
4. IF カスタム用語集がアップロードされた THEN 翻訳時に優先的に適用する

### 要件6: Markdownドキュメントの翻訳処理
**ユーザーストーリー:** Houdini学習者として、生成されたMarkdown学習ドキュメントを選択した言語に正確に翻訳してもらいたい

#### 受け入れ基準
1. WHEN 翻訳処理が開始された THEN 翻訳マーカー間のテキストのみを抽出して処理する
2. WHEN 技術用語（ノード名、パラメータ名など）が検出された THEN 設定に従って処理する
3. WHEN 文脈に応じた翻訳が必要な場合 THEN チャンク内の文章全体を考慮して適切に翻訳する
4. IF 翻訳品質が低い箇所が検出された THEN フラグを立てて手動確認を促す
5. WHEN 翻訳が完了した THEN 元のMarkdown構造を保持して翻訳結果を反映する
6. WHEN バッチ処理モードが有効な場合 THEN 複数の言語版を順次処理してキューイングする

### 要件7: HTMLドキュメントの変換と最終生成
**ユーザーストーリー:** Houdini学習者として、翻訳されたMarkdownを美しいHTMLドキュメントとして取得したい

#### 受け入れ基準
1. WHEN Markdownの変換が開始された THEN レスポンシブデザインのHTMLテンプレートを適用する
2. WHEN `vimeo://timestamp`リンクを処理する THEN クリック可能なタイムラインナビゲーションに変換する
3. WHEN 画像プレースホルダーを処理する THEN 実際の画像ファイルを動画から自動抽出して配置する
4. WHEN コードブロックを変換する THEN シンタックスハイライトを適用してレンダリングする
5. WHEN 複数言語版が完成した THEN 言語切り替えナビゲーションと言語別ディレクトリ構造を生成する
6. IF 右から左へ書く言語（アラビア語など）の場合 THEN RTLレイアウトを自動適用する
7. WHEN 最終パッケージを生成する THEN すべてのアセットを含む自己完結型HTMLを作成する

### 要件8: 用語集の管理
**ユーザーストーリー:** チュートリアル作成者として、Houdini専門用語の翻訳を一元管理して一貫性を保ちたい

#### 受け入れ基準
1. WHEN 新しい専門用語が検出された THEN 用語集への追加を提案する
2. WHEN 用語集エディタを開いた THEN CSV/JSON形式でインポート/エクスポートできる
3. WHEN 用語の翻訳を更新した THEN 過去に生成されたドキュメントへの反映オプションを提供する
4. IF 複数の翻訳候補が存在する THEN コンテキストに基づいて最適な候補を自動選択する

### 要件7: プレビューと編集機能
**ユーザーストーリー:** Houdini学習者として、生成されたドキュメントをプレビューして必要に応じて編集したい

#### 受け入れ基準
1. WHEN プレビューモードを開いた THEN 実際の表示と同じレイアウトで確認できる
2. WHEN インライン編集モードを有効にした THEN 翻訳テキストを直接編集できる
3. WHEN 編集内容を保存した THEN 変更履歴が記録されて復元可能になる
4. IF 複数人で編集する場合 THEN コメント機能で議論できる

### 要件8: エクスポートと配布
**ユーザーストーリー:** チュートリアル作成者として、完成したドキュメントを様々な形式でエクスポートして配布したい

#### 受け入れ基準
1. WHEN エクスポートを実行した THEN HTML、PDF、Markdown形式から選択できる
2. WHEN オフライン表示用にエクスポートした THEN すべてのアセットを含む自己完結型パッケージを生成する
3. WHEN 配布URLを生成した THEN アクセス制御とアナリティクス追跡を設定できる
4. IF LMS（学習管理システム）統合が必要な場合 THEN SCORM準拠のパッケージを生成する

### 要件9: パフォーマンスとスケーラビリティ
**ユーザーストーリー:** システム管理者として、大量のチュートリアルを効率的に処理できるシステムを運用したい

#### 受け入れ基準
1. WHEN 同時に5つ以上のジョブが投入された THEN キューイングシステムで順次処理する
2. WHEN 1時間以上の長時間動画を処理する THEN メモリ使用量が2GB以下に収まる
3. WHEN システム負荷が高い場合 THEN 自動的にスケールアウトして処理を継続する
4. IF 処理中にエラーが発生した THEN 自動リトライとエラー通知を行う

### 要件11: セキュリティとプライバシー
**ユーザーストーリー:** システム管理者として、ユーザーデータと著作権コンテンツを適切に保護したい

#### 受け入れ基準
1. WHEN ユーザーがログインする THEN OAuth2.0/SAMLによる認証を実行する
2. WHEN 処理済みデータを保存する THEN 暗号化してユーザーごとに分離する
3. WHEN 一時ファイルが生成された THEN 処理完了後に自動削除する
4. IF 著作権保護されたコンテンツを検出した THEN 処理を中断して警告を表示する