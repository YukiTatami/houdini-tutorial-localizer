# Vimeo動画翻訳ワークフロー - ファイル操作不可AIエージェント用

## 🤖 AIエージェントが把握すべき前提（必須）
このファイルはファイル操作能力を持たないAIエージェント（Gemini等）用のガイドラインです。
すべてのファイル操作はユーザーが実行し、エージェントはガイドとサポートを提供します。
**フロー上で実行する各種スクリプトやコードはプロジェクトフォルダ内にすでに存在するものを利用し、AIエージェントが新たに作成してはならない。**

## 🤖 AIエージェント実行指示

### 🎯 ワークフロー概要
Houdiniチュートリアルシリーズ（複数動画・Vimeo埋め込み）からシンプルな日本語学習資料を手動作成サポート

**成果物**:
- チャプター別動画同期型学習ガイド（HTML形式）

**ワークフローの特徴**:
- 👥 **協働作業**: ユーザーとエージェントの明確な役割分担
- 📝 **手動操作**: ユーザーがファイル作成・編集を実行
- 🤝 **ガイド提供**: エージェントが詳細な指示とサポートをステップバイステップで提供

### STEP 0: 初期診断・ワークフロー開始

#### 0-1: エージェント能力確認
```
必要能力: テキスト処理、翻訳、ガイド提供
確認結果: MANUAL（手動サポートモード）
```

#### 0-2: ワークフロー概要説明
ユーザーに以下の概要を説明：

**🎯 このワークフローで実現すること**:
```
📽️ 複数動画シリーズ → 📚 シンプルな日本語学習資料の作成

成果物
✅ チャプター別動画同期型学習ガイド（HTML形式）
```

**🔄 処理の流れ**:
```
STEP 1: 環境準備（シリーズ全体フォルダ構造を手動作成）
STEP 2: チャプター選択・字幕取得準備
STEP 3: JavaScript字幕取得（英語）
STEP 4: 英語字幕の簡易確認
STEP 5: 翻訳実行
STEP 6: Python機械処理・マークダウン生成・HTML変換
STEP 7: 次チャプター処理（STEP 2に戻る）
```

**⚠️ ユーザー作業**:
- すべてのファイル作成・編集・保存
- フォルダ構造の作成
- ブラウザでのJavaScript実行
- Pythonスクリプトの実行

#### 0-3: 現在状態の確認
ユーザーに以下を指示：
「プロンプトが配置されているフォルダ内にあるtutorialsフォルダを確認してください」

### STEP 1: 環境準備

#### 1-1: シリーズ情報収集と分析
1. ユーザーにチュートリアルURL（シリーズページ）の情報提供を依頼
2. AIエージェントがURLにアクセスし、以下を確認：
   - シリーズ全体のタイトル
   - 各チャプターのタイトルと番号
   - チャプター数の合計
3. **チャプター一覧の明確化**：
   AIエージェントが以下の形式でチャプター情報を整理して提示：
   ```
   シリーズ名: [実際のシリーズ名]
   チャプター構成:
   - Chapter 01: [実際のチャプター1のタイトル]
   - Chapter 02: [実際のチャプター2のタイトル]
   - Chapter 03: [実際のチャプター3のタイトル]
   ...
   ```
4. **確認ステップ**：
   「上記のチャプター構成で間違いありませんか？」とユーザーに確認

#### 1-2: 具体的フォルダ構造作成指示

**📁 AIエージェントから具体的な作成指示**:
前ステップで確認したチャプター情報を基に、以下の具体的なフォルダ構造とファイルをtutorialsフォルダ内に手動で作成してください：

```
tutorials/[実際のシリーズ名]/
├── 01_raw_data/
│   ├── chapter_01_[実際のチャプター1名]/
│   │   ├── transcript_en.srt（空ファイル）
│   │   └── transcript_jp.srt（空ファイル）
│   ├── chapter_02_[実際のチャプター2名]/
│   │   ├── transcript_en.srt（空ファイル）
│   │   └── transcript_jp.srt（空ファイル）
│   └── chapter_03_[実際のチャプター3名]/
│       ├── transcript_en.srt（空ファイル）
│       └── transcript_jp.srt（空ファイル）
│   （実際のチャプター数分のフォルダとファイル）
└── 03_learning_guide/
    └── chapters/
```

**AIエージェントの具体例提示**:
例えば「Project Skylark Bridges」の場合：
```
tutorials/Project_Skylark_Bridges/
├── 01_raw_data/
│   ├── chapter_01_basic_logic/
│   │   ├── transcript_en.srt（空ファイル）
│   │   └── transcript_jp.srt（空ファイル）
│   ├── chapter_02_piers_and_support_structures/
│   │   ├── transcript_en.srt（空ファイル）
│   │   └── transcript_jp.srt（空ファイル）
│   └── ...（全6チャプター分）
└── 03_learning_guide/
    └── chapters/
```

**重要な変更点**:
- AIエージェントは必ず実際のチャプター名を使用
- テンプレート形式（[チャプター名]）ではなく、具体的な名前で指示
- ユーザーがコピー&ペーストで作業できるよう明確に表示

#### 1-3: 進捗管理の初期化

**📝 進捗管理について**:
- 進捗管理ファイルの作成や更新は行いません
- エージェントとの対話のみで進捗を管理します
- 各ステップ完了時にエージェントが口頭で確認を取ります

#### 1-4: 作成確認
ユーザーに確認：「フォルダ構造の作成が完了しましたか？」

### STEP 2: チャプター選択・字幕取得準備

#### 2-1: 処理チャプター選択
エージェントがユーザーに質問：
「どのチャプターから処理を開始しますか？」
- オプション1: Chapter 1から順番に処理
- オプション2: 特定のチャプターを指定

### STEP 3: JavaScript字幕取得実行

#### 3-1: JavaScript実行手順

**🌐 ブラウザでのユーザー作業手順**:

1. **動画準備**:
   - 該当チャプターの動画ページを開く
   - 英語字幕を有効化
   - 動画を一度再生して一時停止

2. **開発者ツール起動**:
   - F12キーを押して開発者ツールを開く
   - 「Console」タブを選択

3. **Step 1 JavaScript実行**:
   - 「プロジェクトフォルダ内の `scripts/vimeo_subtitle_extractor_step1.js` ファイルは存在しますか？」
   - 存在する場合：ファイルをメモ帳等で開き、全内容をコピーしてConsoleに貼り付け実行と字幕取得処理の完了まで待機を指示
   - 存在しない場合：「プロンプトがあるフォルダ内を確認してください」と報告

4. **Step 2 JavaScript実行**:
   - 「プロジェクトフォルダ内の `scripts/vimeo_subtitle_extractor_step2.js` ファイルは存在しますか？」
   - 存在する場合：ファイルをメモ帳等で開き、全内容をコピーしてConsoleに貼り付け実行を指示
   - 存在しない場合：「プロンプトがあるフォルダ内を確認してください」と報告

5. **SRTデータ保存**:
   - Console出力の「===== COPY THE TEXT BELOW =====」以下をすべて選択・コピー
   - 該当チャプターフォルダの`transcript_en.srt`ファイルを開く（STEP 1-2で作成済み）
   - ファイルの内容を全て選択（Ctrl+A）して削除し、コピーした内容を貼り付け
   - UTF-8エンコーディングで保存（重要）

6. **完了報告**:
   「SRTファイルの保存が完了しました」と報告してください。

#### 3-2: 英語SRTデータの品質修正

**📝 ユーザー作業手順**:

1. **スクリプトの確認**:
   - プロジェクトフォルダで`scripts/srt_quality_fixer.py`ファイルを探してください
   - 見つかった場合は「スクリプトが見つかりました」と報告
   - 見つからない場合は「プロンプトのあるフォルダを確認してください」と指示

2. **コマンド実行**:
   以下のテンプレートを実際のパスに置き換えて実行してください：
   ```
   python scripts/srt_quality_fixer.py "tutorials/[実際のシリーズ名]/01_raw_data/chapter_[実際の章番号]_[実際のチャプター名]/transcript_en.srt" "tutorials/[実際のシリーズ名]/01_raw_data/chapter_[実際の章番号]_[実際のチャプター名]/transcript_en_fixed.srt"
   ```

3. **結果の報告**:
   - 成功した場合：「品質修正が完了しました」
   - エラーが出た場合：エラーメッセージをコピーして報告してください

### STEP 4: 英語字幕の確認

#### 4-1: 英語字幕内容の共有

**📋 ユーザーへの指示**:
`transcript_en_fixed.srt`ファイルの内容をコピーして、この会話に貼り付けてください。

#### 4-2: 簡易確認実行

**AIエージェントが以下を実行**：
- 字幕内容の確認と理解
- 基本的な内容の把握
- 翻訳準備（AIエージェント自身が翻訳を実行するため）

**⚠️ 注意事項**：
- AIエージェント（Gemini等）が直接翻訳を行います
- ノード情報の抽出は行いません（手動ワークフローではオミット）

#### 4-3: 進捗確認

**✅ 英語字幕確認完了**:
エージェントが確認：「英語字幕の内容確認が完了しました。次のステップでは、私（AIエージェント）が直接翻訳を行います。」

### STEP 5: 翻訳実行（AIエージェントが直接実行）

#### 5-1: AIエージェントによる翻訳処理

**🤖 重要：AIエージェント（Gemini等）が直接翻訳を実行します**

エージェントが以下のルールで英語字幕を日本語に翻訳：
- **Pythonスクリプトは使用しません**
- SRT形式を完全に維持
- タイムスタンプとシーケンス番号を保持
- 技術用語は適切に翻訳
- Houdiniノード名は英語表記のまま（例: "Box SOP"）
- 翻訳結果をテキストとして出力

#### 5-2: 翻訳結果の保存

**📝 ユーザーへの保存指示**:

**AIエージェントからの指示**:
「以下に翻訳した日本語字幕を提供します。これをコピーしてファイルに保存してください。」

**日本語字幕ファイルへの保存**:
   - パス: `tutorials/[シリーズ名]/01_raw_data/chapter_[章番号]_[チャプター名]/transcript_jp.srt`（STEP 1-2で作成済み）
   - 空のtranscript_jp.srtファイルを開く
   - ファイルの内容を全て選択（Ctrl+A）してAIエージェントが出力した翻訳済みSRTデータをコピー＆ペースト
   - UTF-8エンコーディングで保存（重要）

### STEP 6: Python機械処理・マークダウン生成・HTML変換

#### 6-1: 入力ファイル確認

以下のファイルが存在することを確認してください：
- 日本語字幕: `transcript_jp.srt`

#### 6-2: マークダウン生成実行

**💻 コマンドラインでの作業**:

1. **スクリプトの存在確認**:
   「`scripts/markdown_generator.py` ファイルは存在しますか？」

2. **実行コマンド**:
   - 存在する場合：以下のコマンドを正確に実行してください
   ```bash
   python scripts/markdown_generator.py --subtitle-file "tutorials/[シリーズ名]/01_raw_data/chapter_[章番号]_[チャプター名]/transcript_jp.srt" --output "tutorials/[シリーズ名]/03_learning_guide/chapters/chapter_[章番号]_[チャプター名]_学習ガイド.md"
   ```
   - 存在しない場合：「プロンプトのあるフォルダを確認してください」と指示

※ 実際のパスに置き換えて実行してください。

**📝 処理の流れ**:
- まずマークダウンファイル（.md）を生成
- その後、別のスクリプトでHTML変換を実行

#### 6-3: HTML変換実行

**💻 コマンドラインでの作業**:

1. **スクリプトの存在確認**:
   「`scripts/md_to_html_converter.py` ファイルは存在しますか？」

2. **実行コマンド**:
   - 存在する場合：以下のコマンドを実行してください
   ```bash
   python scripts/md_to_html_converter.py "tutorials/[シリーズ名]/03_learning_guide/chapters/chapter_[章番号]_[チャプター名]_学習ガイド.md"
   ```
   - 存在しない場合：「プロンプトのあるフォルダを確認してください」と指示

これにより自動的にHTMLファイルが生成されます。

#### 6-4: 進捗確認

**✅ チャプター完了の確認**:
エージェントが確認：「このチャプターのマークダウン・HTML生成が完了しました。チャプター全体の処理が終了しました。」

### STEP 7: 次チャプター処理・完了判定

#### 7-1: 処理継続確認

「現在のチャプター処理が完了しました。次の選択肢を選んでください：」
1. 🔄 次のチャプターを処理する（STEP 2へ）
2. ⏸️ 一時停止する
3. ✅ シリーズ全体が完了

#### 7-2: シリーズ完了時の確認事項

全チャプター完了時のチェックリスト：
- [ ] すべてのチャプターのSRTファイル（英語・日本語）が存在
- [ ] すべてのチャプターの学習ガイド（MD・HTML）が存在
- [ ] ファイル構造が整理されている

エージェントが口頭で完了チャプター数を確認し、シリーズ全体の完了を宣言します。

## 📋 実行時の注意事項

1. **ファイル操作**: すべてのファイル作成・編集はユーザーが実行
2. **エンコーディング**: 必ずUTF-8で保存
3. **パス指定**: コマンド実行時は正確なパスを使用
4. **進捗管理**: 各ステップ完了後にエージェントと口頭で確認

## 🤝 エージェントとユーザーの役割分担

**エージェントの役割**:
- 詳細な手順の提供
- 翻訳処理
- トラブルシューティングサポート
- 対話による進捗確認とガイド

**ユーザーの役割**:
- ファイル・フォルダの作成
- ブラウザでのJavaScript実行
- Pythonスクリプトの実行
- ファイルの保存と管理
- エージェントとの進捗共有

## 📂 参照ファイル

- **共通情報**: `workflow_common_resources.md`
  - JavaScript字幕取得コード
  - フォルダ構造・命名規則
  - Python自動化ツール